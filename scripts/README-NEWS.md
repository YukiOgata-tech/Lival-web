# ãŠçŸ¥ã‚‰ã›è¿½åŠ ã‚¹ã‚¯ãƒªãƒ—ãƒˆä½¿ç”¨ã‚¬ã‚¤ãƒ‰

Firestoreã«ç›´æ¥ãŠçŸ¥ã‚‰ã›ã‚’è¿½åŠ ã™ã‚‹ãŸã‚ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚

## ğŸ“‹ å‰ææ¡ä»¶

### 1. Firebase Admin SDKã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
npm install firebase-admin --save-dev
```

### 2. Firebaseèªè¨¼è¨­å®š

ä»¥ä¸‹ã®ã„ãšã‚Œã‹ã®æ–¹æ³•ã§èªè¨¼ã‚’è¨­å®šã—ã¦ãã ã•ã„ï¼š

#### æ–¹æ³•A: ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚­ãƒ¼ã‚’ä½¿ç”¨ï¼ˆæ¨å¥¨ï¼‰

1. [Firebase Console](https://console.firebase.google.com/) ã«ã‚¢ã‚¯ã‚»ã‚¹
2. `lival-app` ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é¸æŠ
3. **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­å®š** â†’ **ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ** ã‚¿ãƒ–
4. **æ–°ã—ã„ç§˜å¯†éµã®ç”Ÿæˆ** ã‚’ã‚¯ãƒªãƒƒã‚¯
5. ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸJSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’ `scripts/serviceAccountKey.json` ã¨ã—ã¦ä¿å­˜
6. `add-news.js` ã®åˆæœŸåŒ–éƒ¨åˆ†ã‚’ä»¥ä¸‹ã«å¤‰æ›´ï¼š

```javascript
const serviceAccount = require('./serviceAccountKey.json');

admin.initializeApp({
  credential: admin.credential.cert(serviceAccount),
  projectId: 'lival-app'
});
```

#### æ–¹æ³•B: ç’°å¢ƒå¤‰æ•°ã‚’ä½¿ç”¨

```bash
# Windows (PowerShell)
$env:GOOGLE_APPLICATION_CREDENTIALS="C:\path\to\serviceAccountKey.json"

# macOS/Linux
export GOOGLE_APPLICATION_CREDENTIALS="/path/to/serviceAccountKey.json"
```

---

## ğŸš€ ä½¿ã„æ–¹

### åŸºæœ¬çš„ãªä½¿ã„æ–¹

1. `scripts/add-news.js` ã‚’é–‹ã
2. `newsData` é…åˆ—ã«ãŠçŸ¥ã‚‰ã›ã‚’è¨˜è¿°
3. ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œ

```bash
node scripts/add-news.js
```

### ãŠçŸ¥ã‚‰ã›ãƒ‡ãƒ¼ã‚¿ã®è¨˜è¿°ä¾‹

```javascript
const newsData = [
  {
    title: 'ãŠçŸ¥ã‚‰ã›ã®ã‚¿ã‚¤ãƒˆãƒ«',
    content: `
      <h2>è¦‹å‡ºã—</h2>
      <p>æœ¬æ–‡ã‚’ã“ã“ã«æ›¸ãã¾ã™ã€‚HTMLã‚¿ã‚°ãŒä½¿ãˆã¾ã™ã€‚</p>
      <ul>
        <li>ç®‡æ¡æ›¸ã1</li>
        <li>ç®‡æ¡æ›¸ã2</li>
      </ul>
    `,
    priority: 'high',        // 'urgent' | 'high' | 'normal' | 'low'
    type: 'feature',         // 'general' | 'maintenance' | 'feature' | 'system'
    status: 'published',     // 'draft' | 'published' | 'archived'
  }
];
```

---

## ğŸ“ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰èª¬æ˜

### å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | å‹ | èª¬æ˜ | ä¾‹ |
|---|---|---|---|
| `title` | string | ãŠçŸ¥ã‚‰ã›ã‚¿ã‚¤ãƒˆãƒ« | "æ–°æ©Ÿèƒ½ãƒªãƒªãƒ¼ã‚¹ã®ãŠçŸ¥ã‚‰ã›" |
| `content` | string | ãŠçŸ¥ã‚‰ã›æœ¬æ–‡ï¼ˆHTMLå¯ï¼‰ | "<p>æœ¬æ–‡...</p>" |

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | å‹ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ | é¸æŠè‚¢ |
|---|---|---|---|
| `priority` | string | 'normal' | 'urgent', 'high', 'normal', 'low' |
| `type` | string | 'general' | 'general', 'maintenance', 'feature', 'system' |
| `status` | string | 'published' | 'draft', 'published', 'archived' |
| `excerpt` | string | è‡ªå‹•ç”Ÿæˆ | æ‰‹å‹•ã§æŒ‡å®šå¯èƒ½ |
| `authorId` | string | 'admin' | ä»»æ„ã®æ–‡å­—åˆ— |
| `authorName` | string | 'LIVAL AIé‹å–¶ãƒãƒ¼ãƒ ' | ä»»æ„ã®æ–‡å­—åˆ— |

---

## ğŸ¨ å„ªå…ˆåº¦ã¨ã‚¿ã‚¤ãƒ—ã®ä½¿ã„åˆ†ã‘

### å„ªå…ˆåº¦ (priority)

| å€¤ | è¡¨ç¤ºå | ç”¨é€” |
|---|---|---|
| `urgent` | ç·Šæ€¥ | ã‚·ã‚¹ãƒ†ãƒ éšœå®³ã€ç·Šæ€¥ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ãªã© |
| `high` | é‡è¦ | é‡è¦ãªæ–°æ©Ÿèƒ½ã€å¤§ããªå¤‰æ›´ãªã© |
| `normal` | é€šå¸¸ | ä¸€èˆ¬çš„ãªãŠçŸ¥ã‚‰ã› |
| `low` | å‚è€ƒ | å‚è€ƒæƒ…å ±ã€è»½å¾®ãªå¤‰æ›´ãªã© |

### ã‚¿ã‚¤ãƒ— (type)

| å€¤ | è¡¨ç¤ºå | ã‚¢ã‚¤ã‚³ãƒ³ | ç”¨é€” |
|---|---|---|---|
| `general` | ä¸€èˆ¬ | ğŸ“¢ | ä¸€èˆ¬çš„ãªãŠçŸ¥ã‚‰ã› |
| `maintenance` | ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ | ğŸ”§ | ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹æƒ…å ± |
| `feature` | æ–°æ©Ÿèƒ½ | âœ¨ | æ–°æ©Ÿèƒ½è¿½åŠ ãƒ»ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ |
| `system` | ã‚·ã‚¹ãƒ†ãƒ  | âš™ï¸ | ã‚·ã‚¹ãƒ†ãƒ é–¢é€£ã®é€šçŸ¥ |

---

## ğŸ“‹ å®Ÿè¡Œä¾‹

### ä¾‹1: å˜ä¸€ã®ãŠçŸ¥ã‚‰ã›ã‚’è¿½åŠ 

```javascript
const newsData = [
  {
    title: 'ã€é‡è¦ã€‘æ–™é‡‘ãƒ—ãƒ©ãƒ³å¤‰æ›´ã®ãŠçŸ¥ã‚‰ã›',
    content: `
      <p>2025å¹´3æœˆ1æ—¥ã‚ˆã‚Šã€æ–™é‡‘ãƒ—ãƒ©ãƒ³ã‚’å¤‰æ›´ã„ãŸã—ã¾ã™ã€‚</p>
      <p>è©³ç´°ã¯æ–™é‡‘ãƒšãƒ¼ã‚¸ã‚’ã”ç¢ºèªãã ã•ã„ã€‚</p>
    `,
    priority: 'high',
    type: 'general',
    status: 'published',
  }
];
```

```bash
node scripts/add-news.js
```

**å‡ºåŠ›ä¾‹**:
```
ğŸ“¢ 1ä»¶ã®ãŠçŸ¥ã‚‰ã›ã‚’è¿½åŠ ã—ã¾ã™...

[1/1] è¿½åŠ ä¸­...
âœ… ãŠçŸ¥ã‚‰ã›ã‚’è¿½åŠ ã—ã¾ã—ãŸï¼
ğŸ“„ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆID: abc123def456
ğŸ“ ã‚¿ã‚¤ãƒˆãƒ«: ã€é‡è¦ã€‘æ–™é‡‘ãƒ—ãƒ©ãƒ³å¤‰æ›´ã®ãŠçŸ¥ã‚‰ã›
ğŸ”— URL: https://console.firebase.google.com/project/lival-app/firestore/data/news/abc123def456

âœ… ã™ã¹ã¦ã®ãŠçŸ¥ã‚‰ã›ã‚’è¿½åŠ ã—ã¾ã—ãŸï¼

ğŸ‰ å‡¦ç†ãŒå®Œäº†ã—ã¾ã—ãŸï¼
```

### ä¾‹2: è¤‡æ•°ã®ãŠçŸ¥ã‚‰ã›ã‚’ä¸€æ‹¬è¿½åŠ 

```javascript
const newsData = [
  {
    title: 'ãŠçŸ¥ã‚‰ã›1',
    content: 'å†…å®¹1',
    priority: 'high',
    type: 'feature',
  },
  {
    title: 'ãŠçŸ¥ã‚‰ã›2',
    content: 'å†…å®¹2',
    priority: 'normal',
    type: 'general',
  },
  {
    title: 'ãŠçŸ¥ã‚‰ã›3',
    content: 'å†…å®¹3',
    priority: 'urgent',
    type: 'maintenance',
  }
];
```

---

## ğŸ› ï¸ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚¨ãƒ©ãƒ¼: "Could not load the default credentials"

**åŸå› **: Firebaseèªè¨¼æƒ…å ±ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚

**è§£æ±ºç­–**:
1. ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚­ãƒ¼ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
2. ç’°å¢ƒå¤‰æ•° `GOOGLE_APPLICATION_CREDENTIALS` ã‚’è¨­å®š
3. ã¾ãŸã¯ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆå†…ã§ç›´æ¥ã‚­ãƒ¼ã‚’èª­ã¿è¾¼ã‚€

### ã‚¨ãƒ©ãƒ¼: "Permission denied"

**åŸå› **: Firestoreã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«ã§æ›¸ãè¾¼ã¿ãŒæ‹’å¦ã•ã‚Œã¦ã„ã¾ã™ã€‚

**è§£æ±ºç­–**:
- Firebase Admin SDKã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«ã¯é©ç”¨ã•ã‚Œã¾ã›ã‚“
- ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚­ãƒ¼ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

### ã‚¨ãƒ©ãƒ¼: "Cannot find module 'firebase-admin'"

**åŸå› **: `firebase-admin` ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚

**è§£æ±ºç­–**:
```bash
npm install firebase-admin --save-dev
```

---

## ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ³¨æ„äº‹é …

âš ï¸ **é‡è¦**: `serviceAccountKey.json` ã¯ç§˜å¯†æƒ…å ±ã§ã™ï¼

- **çµ¶å¯¾ã«Gitã«ã‚³ãƒŸãƒƒãƒˆã—ãªã„**
- `.gitignore` ã«è¿½åŠ ã™ã‚‹
- æœ¬ç•ªç’°å¢ƒã§ã¯ç’°å¢ƒå¤‰æ•°ã‚’ä½¿ç”¨ã™ã‚‹

```gitignore
# .gitignore ã«è¿½åŠ 
scripts/serviceAccountKey.json
serviceAccountKey.json
```

---

## ğŸ“š é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [ãŠçŸ¥ã‚‰ã›æ©Ÿèƒ½ãƒ‡ãƒ¼ã‚¿æ§‹é€ ](../docs/DATABASE-STRUCTURE.md#4-news-ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³-å®Ÿè£…æ¸ˆã¿ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œ)
- [ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªé€£æºã‚¬ã‚¤ãƒ‰](../docs/MOBILE-NEWS-INTEGRATION.md)
- [Firebase Admin SDK ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://firebase.google.com/docs/admin/setup)

---

## ğŸ’¡ Tips

### HTMLã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è¨˜è¿°

æ”¹è¡Œã‚„ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã‚’å«ã‚ãŸHTMLã‚’è¨˜è¿°ã™ã‚‹å ´åˆã¯ã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒªãƒ†ãƒ©ãƒ«ï¼ˆãƒãƒƒã‚¯ã‚¯ã‚©ãƒ¼ãƒˆï¼‰ã‚’ä½¿ç”¨ã—ã¾ã™ï¼š

```javascript
content: `
  <h2>è¦‹å‡ºã—</h2>
  <p>æ®µè½1</p>
  <p>æ®µè½2</p>
  <ul>
    <li>é …ç›®1</li>
    <li>é …ç›®2</li>
  </ul>
`
```

### ä¸‹æ›¸ãä¿å­˜

ã™ãã«å…¬é–‹ã›ãšã€ä¸‹æ›¸ãã¨ã—ã¦ä¿å­˜ã™ã‚‹å ´åˆï¼š

```javascript
{
  title: 'ä¸‹æ›¸ãã®ãŠçŸ¥ã‚‰ã›',
  content: 'å†…å®¹...',
  status: 'draft',  // ä¸‹æ›¸ãçŠ¶æ…‹
}
```

å¾Œã§Firebaseã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‹ã‚‰ `status` ã‚’ `published` ã«å¤‰æ›´ã™ã‚‹ã¨å…¬é–‹ã•ã‚Œã¾ã™ã€‚

---

**æœ€çµ‚æ›´æ–°**: 2025å¹´11æœˆ
**ä½œæˆè€…**: LIVAL AIé–‹ç™ºãƒãƒ¼ãƒ 
